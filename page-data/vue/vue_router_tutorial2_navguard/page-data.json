{"componentChunkName":"component---src-templates-post-template-tsx","path":"/vue/vue_router_tutorial2_navguard/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<blockquote>\n<p>Vue Router 공식문서를 참조하여 정리하였습니다.</p>\n</blockquote>\n<hr>\n<h2>네비게이션 가드란?</h2>\n<ul>\n<li>사용자가 특정 URL에 접근하지 못하게 막는 방법</li>\n<li>로그인과 같은 사용자 인증 구현과 관련이 있음</li>\n<li>Vue router에서 네비게이션 가드는 3가지 방법으로 구현이 가능\n<ol>\n<li>전역 가드</li>\n<li>라우트 가드</li>\n<li>컴포넌트 가드</li>\n</ol>\n</li>\n</ul>\n<h2>전역 가드</h2>\n<ul>\n<li>네비게이션 발생시마다 가드가 실행됨\n<ul>\n<li>가드는 비동기적으로 실행이 가능</li>\n<li>네비게이션은 모든 훅이 해결되기전까지 <strong>보류상태</strong></li>\n</ul>\n</li>\n</ul>\n<h3>전역 가드 설정</h3>\n<ul>\n<li>router 객체를 <code class=\"language-text\">VueRouter</code>를 통해 생성</li>\n<li><code class=\"language-text\">router.beforeEach</code>를 사용해서 전역 가드를 등록하기</li>\n<li>이때, <strong><code class=\"language-text\">next</code> 함수를 꼭 호출해야 네비게이션이 정상적으로 작동함</strong> (훅 해결전까지 보류상태!)\n<ul>\n<li><code class=\"language-text\">next()</code> : 다음 훅으로 이동. 훅이 없으면 네비게이션 작동</li>\n<li><code class=\"language-text\">next(false)</code> : 요청된 네비게이션 중단. <code class=\"language-text\">from</code>에 정의된 라우트로 돌아감</li>\n<li><code class=\"language-text\">next('/')</code> : 현 네비게이션을 중단하고, 지정한 라우트로 리다이렉트</li>\n<li><code class=\"language-text\">next(error)</code> : error가 있으면, <code class=\"language-text\">router.onError()</code>으로 등록된 콜백에 에러 전달</li>\n</ul>\n</li>\n<li><code class=\"language-text\">router.beforeResolve</code> (2.5.0에서 추가)\n<ul>\n<li>모든 컴포넌트 가드 + 라우트 컴포넌트를 로딩한 후, 네비게이션 가드를 확인하기 전에 호출됨</li>\n</ul>\n</li>\n</ul>\n<h3>전역 가드 예시</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">VueRouter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">routes</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'home'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">component</span><span class=\"token operator\">:</span> Home <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token comment\">// ...</span>\r\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">to<span class=\"token punctuation\">,</span> from<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token comment\">// to: 이동할 라우트 객체</span>\r\n  <span class=\"token comment\">// from: \b이동하기전 라우트 객체</span>\r\n  <span class=\"token comment\">// next: 네비게이션 전에 해결되야하는 훅 함수</span>\r\n  <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<hr>\n<h2>라우트 가드</h2>\n<ul>\n<li>특정 라우트 (URL)에 접속하게되면 가드 발생</li>\n<li><code class=\"language-text\">beforeEnter</code>로 <code class=\"language-text\">VueRouter</code> 인스턴스에 직접 정의</li>\n</ul>\n<h3>라우트 가드 예시</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">VueRouter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">routes</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'home'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">component</span><span class=\"token operator\">:</span> Home<span class=\"token punctuation\">,</span>\r\n      <span class=\"token function-variable function\">beforeEnter</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">to<span class=\"token punctuation\">,</span> from<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token comment\">// ...</span>\r\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<hr>\n<h2>컴포넌트 가드</h2>\n<ul>\n<li>특정 컴포넌트가 호출되면 네비게이션 가드가 작동</li>\n<li><code class=\"language-text\">beforeRouterEnter</code>, <code class=\"language-text\">beforeRouterUpdate</code>와 <code class=\"language-text\">beforeRouterLeave</code>를 사용하여 Vue component에 정의\n<ul>\n<li><code class=\"language-text\">beforeRouterEnter</code>의 특징\n<ul>\n<li>네비게이션 전에 가드가 호출</li>\n<li>컴포넌트 생성이 안되어서, <code class=\"language-text\">this</code> 객체에 접근 불가</li>\n<li><code class=\"language-text\">next(vm=>{})</code>과 같이 <code class=\"language-text\">vm</code>을 통해 컴포넌트 인스턴스 접근으로 <code class=\"language-text\">this</code> 사용이 가능해짐</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3>컴포넌트 가드 예시</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> Home <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">template</span><span class=\"token operator\">:</span> <span class=\"token string\">'&lt;p> Hello World! &lt;/p>'</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token function\">beforeRouterEnter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">to<span class=\"token punctuation\">,</span> from<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// 이 컴포넌트로 네비게이션 되기 전에 실행</span>\r\n    <span class=\"token comment\">// Home 컴포넌트는 아직 렌더링 되지 않음</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token function\">beforeRouterUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">to<span class=\"token punctuation\">,</span> from<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// Home 컴포넌트의 내용이 변경되면 실행</span>\r\n    <span class=\"token comment\">// `this` 객체에 접근이 가능 => 왜? => 이미 렌더링이 되었기 때문</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token function\">beforeRouterLeave</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">to<span class=\"token punctuation\">,</span> from<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// Home 컴포넌트를 떠나기 전에 실행</span>\r\n    <span class=\"token comment\">// 사용자가 저장하지 않은 편집 내용을 두고 실수로 떠나는 것을 방지</span>\r\n    <span class=\"token comment\">// next(false)를 써서 이동 취소</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h2>메타 필드</h2>\n<ul>\n<li>라우트를 만들면서 검색엔진에 문서의 내용을 요약해주는 메타 필드를 포함 가능</li>\n<li><code class=\"language-text\">meta: {...}</code> 를 <code class=\"language-text\">VueRouter</code> 인스턴스에 적으면 끝</li>\n</ul>\n<h3>메타 필드에 접근하기</h3>\n<ul>\n<li>모든 라우트 레코드는 <code class=\"language-text\">$route</code> 객체에 <code class=\"language-text\">$router.matched</code>로 전달됨</li>\n<li>라우트 레코드는 중첩가능</li>\n</ul>\n<h3>전역 가드에서 메타 필드 확인</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">router<span class=\"token punctuation\">.</span><span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">to<span class=\"token punctuation\">,</span> from<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>to<span class=\"token punctuation\">.</span>matched<span class=\"token punctuation\">.</span><span class=\"token function\">some</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">record</span> <span class=\"token operator\">=></span> record<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">.</span>requiresAuth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// 메타 필드 가져오기</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<hr>\n<h2>라우터에서의 데이터 핸들링</h2>\n<ul>\n<li>라우트가 활성화되면 서버에서 데이터를 가져와야함\n<ul>\n<li>탐색 후 가져오기\n<ul>\n<li>컴포넌트의 <code class=\"language-text\">created()</code> 훅에서 데이터를 가져옴</li>\n<li>로드 상태를 표시 가능</li>\n</ul>\n</li>\n<li>탐색 전 가져오기\n<ul>\n<li>라우트 가드에서 네비게이션 전에 데이터를 가져옴</li>\n<li>가져오기 실패시, 경고 메세지 띄우는거 추천</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3>방법 1. 탐색 후</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">loading</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token literal-property property\">methods</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>loading <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token function\">created</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// 컴포넌트가 렌더링되면 데이터를 가져옴</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>방법 2. 탐색 전</h3>\n<hr>\n<h2>마무리</h2>\n<p>틀린 내용이 있다면 자유롭게 댓글로 달아주세요 :)</p>","frontmatter":{"title":"[Vue-Router] (2) 네비게이션 가드와 기타 기능들","excerpt":"Vue router에서 라우트를 보호해주는 네비게이션 가드를 정리하는 글입니다.","date":"2019.07.21.","category":"vue","thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQHA//EABYBAQEBAAAAAAAAAAAAAAAAAAEFCP/aAAwDAQACEAMQAAABQVqO8vPstKWJ/8QAGRAAAwEBAQAAAAAAAAAAAAAAAAIEFBID/9oACAEBAAEFAkmXryiqRcxkHn7Mh//EACIRAAEBBgcAAAAAAAAAAAAAAAERAAIDFiIxEiEyUVJxkf/aAAgBAwEBPwGYIiGu+HdaStJsFs8uoZNMETmfem//xAAgEQABAwIHAAAAAAAAAAAAAAABABEhFjIzQVFSYWOh/9oACAECAQE/AaqL4rCHDnKQ2k3bhCqvs9PC/8QAJRAAAAQEBQUAAAAAAAAAAAAAAQIDEgAEETEQEyIyoRQhQWGC/9oACAEBAAY/Ai5gCyoPbub5p7Dm0LdaVMD54py2TtVl07zg1EWlmHFBFK5GKOE3aLYBoIWgU01t9GNxS8Wj/8QAHBABAQACAwEBAAAAAAAAAAAAEQEAITFxkVGx/9oACAEBAAE/IenPPJs2BuSwH04VvZWxLUmtQdXTHjrPZn6sjAOgbIG2uDq9mf/aAAwDAQACAAMAAAAQIP8A/8QAHREBAQABBAMAAAAAAAAAAAAAAREhQVFhcZGhwf/aAAgBAwEBPxAm2btGIgmVhMSiM9bq+uDx3P/EAB0RAQABBAMBAAAAAAAAAAAAAAERACExYUFRkfD/2gAIAQIBAT8QUCTMymd5OaS1hHipdOPo7fNNf//EABsQAQACAwEBAAAAAAAAAAAAAAEAESEx8BDR/9oACAEBAAE/EAOmhYSwV6tXyWUUGmjDjl/NZlUnqE7/ABh7GRxBASMMVHVwR4r/AP/Z"},"images":{"fallback":{"src":"/static/f7a2cb1b53db588bfdc14d4b5dcd2d35/ffa24/logo.jpg","srcSet":"/static/f7a2cb1b53db588bfdc14d4b5dcd2d35/d04ec/logo.jpg 256w,\n/static/f7a2cb1b53db588bfdc14d4b5dcd2d35/6f7c6/logo.jpg 512w,\n/static/f7a2cb1b53db588bfdc14d4b5dcd2d35/ffa24/logo.jpg 1024w","sizes":"(min-width: 1024px) 1024px, 100vw"},"sources":[{"srcSet":"/static/f7a2cb1b53db588bfdc14d4b5dcd2d35/e92ac/logo.webp 256w,\n/static/f7a2cb1b53db588bfdc14d4b5dcd2d35/dcf1b/logo.webp 512w,\n/static/f7a2cb1b53db588bfdc14d4b5dcd2d35/afeb4/logo.webp 1024w","type":"image/webp","sizes":"(min-width: 1024px) 1024px, 100vw"}]},"width":1024,"height":768}},"publicURL":"/static/f7a2cb1b53db588bfdc14d4b5dcd2d35/logo.jpeg"}}}}]}},"pageContext":{"slug":"/vue/vue_router_tutorial2_navguard/"}},"staticQueryHashes":[],"slicesMap":{}}